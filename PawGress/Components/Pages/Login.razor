@page "/"
@layout MainLayout
@using PawGress.Models
@inject NavigationManager Navigation

<link href="app.css" rel="stylesheet" />
<link href="auth.css" rel="stylesheet" />

@code {
    // read query param for error
    private string message = string.Empty;
    private string messageClass = "error";

    protected override void OnInitialized()
    {
        var uri = Navigation.ToAbsoluteUri(Navigation.Uri);
        if (Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(uri.Query).TryGetValue("error", out var val))
        {
            if (val == "invalid") message = "Invalid username or password.";
            else message = "Please sign in.";
        }
    }
}

<div class="auth-page">
    <div class="auth-card">
        <h1 class="auth-title">LOGIN</h1>

        <!-- Use plain form POST so cookie is set in the browser on server response -->
        <form method="post" action="/api/auth/login">
            <input name="username" placeholder="Username" class="auth-input" />
            <input name="password" type="password" placeholder="Password" class="auth-input" />
            <button type="submit" class="auth-button">Login</button>
        </form>

        <p>Don't have an account? <a href="/signup">Sign up</a></p>

        @if (!string.IsNullOrEmpty(message))
        {
            <p class="@messageClass">@message</p>
        }
    </div>
</div>
